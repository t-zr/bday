<!DOCTYPE html>

<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Birthday Card</title>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700&display=swap" rel="stylesheet">
  <style>
    html, body {
      margin: 0;
      padding: 0;
      height: 100vh;
      font-family: 'Orbitron', sans-serif;
      background: radial-gradient(circle, #fff0f5, #ffe4e1);
      overflow: hidden;
      display: flex;
      justify-content: center;
      align-items: center;
      padding: 10px;
      box-sizing: border-box;
    }

```
#birthdayCard {
  position: relative;
  width: min(400px, 90vw);
  height: min(500px, 80vh);
  perspective: 1500px;
  max-width: 100%;
}

.card-inner {
  width: 100%;
  height: 100%;
  transition: transform 1s ease-in-out;
  transform-style: preserve-3d;
  cursor: pointer;
  position: relative;
}

.card-inner.open {
  transform: rotateY(180deg);
}

.card-front, .card-back {
  position: absolute;
  width: 100%;
  height: 100%;
  border-radius: 12px;
  backface-visibility: hidden;
  box-shadow: 0 8px 20px rgba(0, 0, 0, 0.3);
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: 30px 20px;
  box-sizing: border-box;
  text-align: center;
}

.card-front {
  background: linear-gradient(135deg, #ff69b4 0%, #ff1493 25%, #ffd700 50%, #ff6347 75%, #ff69b4 100%);
  background-size: 400% 400%;
  animation: gradient-shift 8s ease infinite;
  color: white;
  position: relative;
  overflow: hidden;
}

.card-front::before {
  content: '';
  position: absolute;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.15), transparent);
  animation: cover-shine 4s linear infinite;
  pointer-events: none;
}

.card-front h1 {
  font-size: clamp(1.5em, 4vw, 2.2em);
  font-weight: 900;
  margin: 0.5em 0;
  text-shadow: 
    3px 3px 6px rgba(0,0,0,0.4),
    0 0 25px rgba(255, 255, 255, 0.6);
  animation: title-glow 3s ease-in-out infinite;
  letter-spacing: 1px;
}

.card-front .birthday-emoji {
  font-size: clamp(2.5em, 6vw, 3.5em);
  margin-bottom: 0.5em;
  animation: cake-bounce 3s ease-in-out infinite;
  filter: drop-shadow(0 5px 15px rgba(255, 215, 0, 0.4));
}

.card-front small {
  font-size: clamp(0.8em, 2vw, 1em);
  margin-top: 1em;
  opacity: 0.9;
  animation: hint-pulse 2s ease-in-out infinite;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.3);
  font-weight: 300;
}

.card-back {
  background: linear-gradient(135deg, #fff8fb, #fff, #fef7ff);
  transform: rotateY(180deg);
  color: #333;
  position: relative;
  overflow: hidden;
}

.card-back::before {
  content: '';
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: 
    radial-gradient(circle at 20% 20%, rgba(255, 105, 180, 0.1) 0%, transparent 50%),
    radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.1) 0%, transparent 50%),
    radial-gradient(circle at 40% 60%, rgba(64, 224, 208, 0.1) 0%, transparent 50%);
  animation: page-sparkle 8s ease-in-out infinite;
  pointer-events: none;
}

.emoji-border {
  font-size: clamp(1.2em, 3vw, 1.8em);
  margin: 0.8em 0;
  animation: party-float 3s ease-in-out infinite;
  filter: drop-shadow(0 3px 8px rgba(255, 105, 180, 0.3));
}

.card-back h2 {
  font-size: clamp(1.2em, 3.5vw, 1.8em);
  font-weight: 700;
  background: linear-gradient(45deg, #ff1493, #ff69b4, #ffd700, #ff6347);
  background-size: 300% 300%;
  -webkit-background-clip: text;
  background-clip: text;
  -webkit-text-fill-color: transparent;
  animation: rainbow-text 3s ease-in-out infinite;
  margin: 0.5em 0;
  text-align: center;
}

/* Fallback for browsers that don't support background-clip: text */
@supports not (-webkit-background-clip: text) {
  .card-back h2 {
    background: none;
    color: #ff1493;
    text-shadow: 2px 2px 4px rgba(255, 20, 147, 0.3);
  }
}

.card-message {
  font-size: clamp(0.9em, 2.5vw, 1.1em);
  margin: 1em 0;
  line-height: 1.5;
  color: #555;
  font-weight: 500;
  text-align: center;
}

/* Animations */
@keyframes gradient-shift {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

@keyframes cover-shine {
  0% { transform: translateX(-100%) translateY(-100%) rotate(45deg); }
  100% { transform: translateX(100%) translateY(100%) rotate(45deg); }
}

@keyframes page-sparkle {
  0%, 100% { opacity: 0.3; }
  50% { opacity: 0.6; }
}

@keyframes cake-bounce {
  0%, 100% { transform: translateY(0) rotate(0deg) scale(1); }
  25% { transform: translateY(-8px) rotate(-2deg) scale(1.05); }
  50% { transform: translateY(-12px) rotate(0deg) scale(1.1); }
  75% { transform: translateY(-6px) rotate(2deg) scale(1.05); }
}

@keyframes title-glow {
  0%, 100% { 
    text-shadow: 
      3px 3px 6px rgba(0,0,0,0.4),
      0 0 25px rgba(255, 255, 255, 0.6);
  }
  50% { 
    text-shadow: 
      3px 3px 6px rgba(0,0,0,0.4),
      0 0 35px rgba(255, 255, 255, 0.9),
      0 0 45px rgba(255, 215, 0, 0.4);
  }
}

@keyframes hint-pulse {
  0%, 100% { 
    opacity: 0.9; 
    transform: scale(1);
  }
  50% { 
    opacity: 0.6; 
    transform: scale(0.98);
  }
}

@keyframes party-float {
  0%, 100% { transform: translateY(0) rotate(0deg); }
  33% { transform: translateY(-5px) rotate(-1deg); }
  66% { transform: translateY(-8px) rotate(1deg); }
}

@keyframes rainbow-text {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* Confetti */
.confetti {
  position: fixed;
  width: 8px;
  height: 8px;
  z-index: 1000;
  pointer-events: none;
  border-radius: 2px;
  animation: confetti-fall linear forwards;
}

@keyframes confetti-fall {
  0% { 
    transform: translateY(-100vh) rotate(0deg); 
    opacity: 1; 
  }
  100% { 
    transform: translateY(100vh) rotate(720deg); 
    opacity: 0; 
  }
}

/* Mobile optimizations */
@media (max-width: 768px) {
  body {
    padding: 5px;
  }
  
  #birthdayCard {
    width: min(350px, 95vw);
    height: min(450px, 85vh);
  }
  
  .card-front, .card-back {
    padding: 20px 15px;
  }
}

@media (max-height: 500px) {
  #birthdayCard {
    height: 90vh;
  }
  
  .card-message {
    font-size: clamp(0.8em, 2vw, 1em);
    line-height: 1.3;
  }
  
  .emoji-border {
    font-size: clamp(1em, 2.5vw, 1.4em);
    margin: 0.5em 0;
  }
}

/* Accessibility */
@media (prefers-reduced-motion: reduce) {
  .card-inner, .birthday-emoji, .emoji-border {
    animation: none !important;
    transition: none !important;
  }
  
  .card-front small {
    animation: none;
    opacity: 0.9;
  }
}
```

  </style>
</head>
<body>
  <div id="birthdayCard">
    <div class="card-inner" id="cardInner">
      <div class="card-front">
        <div class="birthday-emoji">üéÇ</div>
        <h1>üéâ HAPPY BIRTHDAY üéâ</h1>
        <small>Click to open</small>
      </div>
      <div class="card-back">
        <div class="emoji-border">üéÇüéàüéâüéÅüéä</div>
        <h2 id="cardMessage"></h2>
        <div class="card-message">Wishing you a day filled with joy, laughter, and cake! Hope all your birthday wishes come true! ‚ú®</div>
        <div class="emoji-border">üéäüéÅüéâüéàüéÇ</div>
      </div>
    </div>
  </div>

  <script>
    function getNameFromURL() {
      const params = new URLSearchParams(window.location.search);
      return params.get('name')?.trim() || 'Friend';
    }

    function launchConfetti() {
      const colors = ['#ff69b4', '#ffd700', '#40e0d0', '#ff1493', '#00ff7f', '#ff6347'];
      const confettiCount = window.innerWidth < 768 ? 40 : 60;
      
      for (let i = 0; i < confettiCount; i++) {
        setTimeout(() => {
          const confetti = document.createElement('div');
          confetti.className = 'confetti';
          confetti.style.left = Math.random() * 100 + '%';
          confetti.style.backgroundColor = colors[Math.floor(Math.random() * colors.length)];
          confetti.style.animationDuration = (2 + Math.random() * 3) + 's';
          confetti.style.animationDelay = Math.random() * 0.5 + 's';
          
          // Random shapes
          if (Math.random() > 0.5) {
            confetti.style.borderRadius = '50%';
          }
          
          document.body.appendChild(confetti);
          
          setTimeout(() => {
            if (confetti.parentNode) {
              confetti.remove();
            }
          }, 6000);
        }, i * 50);
      }
    }

    function playSong() {
      // Check if user has reduced motion preference
      if (window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
        return;
      }
      
      try {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        
        // Happy Birthday melody (simplified)
        const notes = [
          261.63, 261.63, 293.66, 261.63, 349.23, 329.63,
          261.63, 261.63, 293.66, 261.63, 392.00, 349.23,
          261.63, 261.63, 523.25, 440.00, 349.23, 329.63, 293.66,
          466.16, 466.16, 440.00, 349.23, 392.00, 349.23
        ];
        
        const durations = [
          0.5, 0.25, 0.75, 0.75, 0.75, 1.5,
          0.5, 0.25, 0.75, 0.75, 0.75, 1.5,
          0.5, 0.25, 0.75, 0.75, 0.75, 0.75, 1.5,
          0.5, 0.25, 0.75, 0.75, 0.75, 1.5
        ];
        
        let time = ctx.currentTime + 0.1;

        notes.forEach((note, i) => {
          const oscillator = ctx.createOscillator();
          const gainNode = ctx.createGain();
          
          oscillator.connect(gainNode);
          gainNode.connect(ctx.destination);
          
          oscillator.type = 'triangle';
          oscillator.frequency.value = note;
          
          gainNode.gain.setValueAtTime(0, time);
          gainNode.gain.linearRampToValueAtTime(0.2, time + 0.01);
          gainNode.gain.exponentialRampToValueAtTime(0.001, time + durations[i]);
          
          oscillator.start(time);
          oscillator.stop(time + durations[i]);
          
          time += durations[i] * 0.9;
        });
      } catch (e) {
        console.warn('Audio playback not supported');
      }
    }

    // Setup
    window.addEventListener('load', () => {
      const name = getNameFromURL();
      const messageElement = document.getElementById('cardMessage');
      messageElement.textContent = `Happy Birthday ${name.toUpperCase()}!`;
      
      const cardInner = document.getElementById('cardInner');
      let hasOpened = false;
      
      const handleClick = () => {
        if (!hasOpened) {
          hasOpened = true;
          cardInner.classList.add('open');
          setTimeout(() => {
            playSong();
            launchConfetti();
          }, 500); // Wait for flip animation to start
        }
      };
      
      cardInner.addEventListener('click', handleClick);
      cardInner.addEventListener('touchstart', handleClick, { passive: true });
      
      // Keyboard accessibility
      cardInner.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          handleClick();
        }
      });
      
      // Make card focusable
      cardInner.setAttribute('tabindex', '0');
      cardInner.setAttribute('role', 'button');
      cardInner.setAttribute('aria-label', 'Open birthday card');
    });

    // Handle orientation changes
    window.addEventListener('orientationchange', () => {
      setTimeout(() => {
        window.scrollTo(0, 0);
      }, 100);
    });
  </script>

</body>
</html>
